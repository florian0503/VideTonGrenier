{% extends 'base.html.twig' %}

{% block title %}Contacter le vendeur - {{ annonce.titre }} - VideTonGrenier{% endblock %}

{% block body %}
<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">üí¨ Contacter le vendeur</h3>
                </div>
                <div class="card-body">
                    <!-- Informations sur l'annonce -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            {% if annonce.firstImage %}
                                <img src="{{ annonce.firstImage }}" class="img-fluid rounded" alt="{{ annonce.titre }}">
                            {% else %}
                                <div class="bg-light d-flex align-items-center justify-content-center rounded" style="height: 150px;">
                                    <i class="fas fa-image fa-2x text-muted"></i>
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-8">
                            <h5>{{ annonce.titre }}</h5>
                            {% if annonce.prix %}
                                <p class="h4 text-primary">{{ annonce.prix }}‚Ç¨</p>
                            {% else %}
                                <p class="text-muted">Prix √† n√©gocier</p>
                            {% endif %}
                            <p class="text-muted small">
                                Publi√© par <strong>{{ annonce.user.fullName }}</strong> 
                                le {{ annonce.publishedAt ? annonce.publishedAt|date('d/m/Y') : annonce.createdAt|date('d/m/Y') }}
                            </p>
                            <p class="small">{{ annonce.description|length > 150 ? annonce.description[:150] ~ '...' : annonce.description }}</p>
                        </div>
                    </div>

                    <hr>

                    <!-- Formulaire de contact -->
                    <h6 class="mb-3">Envoyez un message √† {{ annonce.user.fullName }}</h6>
                    
                    {{ form_start(form, {'attr': {'class': 'needs-validation'}}) }}
                    
                    {% if form.vars.errors|length > 0 %}
                        <div class="alert alert-danger">
                            <h6>‚ùå Erreurs dans le formulaire :</h6>
                            {{ form_errors(form) }}
                        </div>
                    {% endif %}

                    <div class="mb-3">
                        {{ form_label(form.contenu, null, {'label_attr': {'class': 'form-label fw-bold'}}) }}
                        {{ form_widget(form.contenu, {
                            'attr': {
                                'placeholder': 'Bonjour, je suis int√©ress√©(e) par votre annonce "' ~ annonce.titre ~ '". Pouvez-vous me donner plus d\'informations ?'
                            }
                        }) }}
                        {{ form_errors(form.contenu) }}
                        <div class="form-text">
                            <i class="fas fa-info-circle"></i> 
                            Soyez poli et pr√©cis dans votre message. N'h√©sitez pas √† poser des questions sur l'√©tat, la disponibilit√©, etc.
                        </div>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="{{ path('app_annonce_show', {id: annonce.id}) }}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Retour √† l'annonce
                        </a>
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-paper-plane"></i> Envoyer le message
                        </button>
                    </div>

                    {{ form_end(form) }}
                </div>
            </div>

            <!-- Conseils -->
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="mb-0">üí° Conseils pour un bon contact</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Soyez poli et respectueux</li>
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Posez des questions pr√©cises sur l'objet</li>
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Proposez un rendez-vous dans un lieu public</li>
                        <li class="mb-0"><i class="fas fa-times text-danger me-2"></i> Ne communiquez jamais vos informations bancaires</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}